<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discrete Event Simulation - ATM Queue (25 Pelanggan)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 5px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        
        .info-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid #667eea;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .info-box h3 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1.3em;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            background: white;
            padding: 12px;
            border-radius: 5px;
            border-left: 3px solid #764ba2;
        }
        
        .info-item strong {
            color: #667eea;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 14px 35px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .btn-start {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        
        .btn-start:hover {
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-pause {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }
        
        .btn-pause:hover {
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }
        
        .btn-reset:hover {
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
            transform: translateY(-2px);
        }
        
        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .speed-control label {
            font-weight: bold;
            color: #333;
        }
        
        .speed-control select {
            padding: 10px 20px;
            border-radius: 5px;
            border: 2px solid #667eea;
            font-size: 14px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }
        
        .stat-card h3 {
            font-size: 0.95em;
            opacity: 0.95;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-card small {
            font-size: 0.85em;
            opacity: 0.9;
        }
        
        .simulation-area {
            background: linear-gradient(135deg, #f9f9f9 0%, #ffffff 100%);
            border: 3px solid #667eea;
            border-radius: 12px;
            padding: 35px;
            margin-bottom: 30px;
            min-height: 450px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .atm-section {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            margin-bottom: 35px;
        }
        
        .atm-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .atm-machine {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            width: 180px;
            height: 260px;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            padding: 20px;
            border: 3px solid #1a252f;
        }
        
        .atm-screen {
            background: linear-gradient(135deg, #3498db, #2980b9);
            width: 100%;
            height: 70px;
            margin-bottom: 12px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 13px;
            text-align: center;
            padding: 8px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
            border: 2px solid #2574a9;
        }
        
        .atm-status {
            background: #95a5a6;
            color: white;
            text-align: center;
            padding: 10px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .atm-status.busy {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            animation: pulse-status 1.5s infinite;
        }
        
        .atm-status.idle {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        @keyframes pulse-status {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .atm-keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            padding: 5px;
        }
        
        .key {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            height: 25px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .atm-label {
            text-align: center;
            margin-top: 12px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .queue-area {
            flex: 1;
        }
        
        .queue-label {
            font-weight: bold;
            margin-bottom: 18px;
            color: #2c3e50;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .queue-line {
            display: flex;
            gap: 18px;
            flex-wrap: wrap;
            align-items: center;
            min-height: 70px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .customer {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 16px;
            transition: all 0.5s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            position: relative;
            cursor: pointer;
        }
        
        .customer::after {
            content: attr(data-info);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #2c3e50;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .customer:hover::after {
            opacity: 1;
        }
        
        .customer.waiting {
            background: linear-gradient(135deg, #3498db, #2980b9);
            animation: pulse 2s infinite;
        }
        
        .customer.serving {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            animation: glow 1.5s infinite;
            transform: scale(1.15);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }
        
        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 0 15px rgba(243, 156, 18, 0.6);
            }
            50% { 
                box-shadow: 0 0 30px rgba(243, 156, 18, 1),
                            0 0 45px rgba(243, 156, 18, 0.8);
            }
        }
        
        .timeline {
            margin-top: 25px;
        }
        
        .timeline-label {
            font-weight: bold;
            margin-bottom: 12px;
            color: #2c3e50;
            font-size: 1.2em;
        }
        
        .timeline-bar {
            background: #ecf0f1;
            height: 50px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .timeline-progress {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }
        
        .event-log {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
            padding: 25px;
            border-radius: 12px;
            max-height: 450px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .event-log::-webkit-scrollbar {
            width: 10px;
        }
        
        .event-log::-webkit-scrollbar-track {
            background: #1a252f;
            border-radius: 5px;
        }
        
        .event-log::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 5px;
        }
        
        .event-log-title {
            font-weight: bold;
            margin-bottom: 18px;
            color: #3498db;
            font-size: 1.3em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .event {
            padding: 8px 0;
            border-bottom: 1px solid #34495e;
            line-height: 1.6;
        }
        
        .event:last-child {
            border-bottom: none;
        }
        
        .event-time {
            color: #f39c12;
            font-weight: bold;
        }
        
        .event-customer {
            color: #3498db;
            font-weight: bold;
        }
        
        .event-action {
            color: #2ecc71;
        }
        
        .event-arrival {
            color: #3498db;
        }
        
        .event-departure {
            color: #e74c3c;
        }
        
        .current-event {
            background: rgba(52, 152, 219, 0.2);
            padding: 8px;
            margin: -8px 0;
            border-radius: 5px;
        }
        
        /* ========================================
           RESPONSIVE MOBILE DESIGN
           ======================================== */
        @media screen and (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
                border-radius: 10px;
            }
            
            h1 {
                font-size: 1.5em;
                margin-bottom: 5px;
            }
            
            .subtitle {
                font-size: 0.85em;
                margin-bottom: 15px;
            }
            
            .info-box {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .info-box h3 {
                font-size: 1.1em;
                margin-bottom: 10px;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .info-item {
                padding: 10px;
                font-size: 0.9em;
            }
            
            .controls {
                gap: 10px;
                margin-bottom: 20px;
            }
            
            button {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .speed-control {
                width: 100%;
            }
            
            .speed-control label {
                font-size: 14px;
            }
            
            .speed-control select {
                padding: 8px;
                font-size: 14px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin-bottom: 20px;
            }
            
            .stat-card {
                padding: 12px;
            }
            
            .stat-card h3 {
                font-size: 0.85em;
                margin-bottom: 8px;
            }
            
            .stat-card .value {
                font-size: 1.5em;
            }
            
            .stat-card small {
                font-size: 0.75em;
            }
            
            .simulation-area {
                flex-direction: column;
                gap: 20px;
            }
            
            .atm-section {
                flex-direction: column;
                gap: 15px;
            }
            
            .atm-container {
                margin: 0 auto;
            }
            
            .atm-machine {
                width: 180px;
                height: 250px;
            }
            
            .atm-screen {
                height: 80px;
                font-size: 12px;
            }
            
            .atm-status {
                font-size: 11px;
                padding: 6px;
            }
            
            .atm-keypad {
                padding: 4px;
                gap: 4px;
            }
            
            .key {
                height: 20px;
            }
            
            .atm-label {
                font-size: 1em;
                margin-top: 10px;
            }
            
            .queue-label {
                font-size: 1.1em;
                margin-bottom: 12px;
            }
            
            .queue-line {
                padding: 15px;
                gap: 12px;
                min-height: 60px;
            }
            
            .customer {
                width: 50px;
                height: 50px;
                font-size: 14px;
            }
            
            .customer::after {
                font-size: 10px;
                bottom: -25px;
            }
            
            .timeline {
                margin-bottom: 20px;
            }
            
            .timeline h3 {
                font-size: 1em;
                margin-bottom: 8px;
            }
            
            .timeline-bar {
                height: 25px;
            }
            
            .timeline-progress {
                font-size: 11px;
                line-height: 25px;
            }
            
            .event-log {
                margin-top: 20px;
            }
            
            .event-log h3 {
                font-size: 1em;
                margin-bottom: 10px;
            }
            
            .log-container {
                max-height: 250px;
                font-size: 0.85em;
            }
            
            .event {
                padding: 8px;
            }
        }
        
        /* Extra small devices (phones in portrait) */
        @media screen and (max-width: 480px) {
            h1 {
                font-size: 1.2em;
            }
            
            .subtitle {
                font-size: 0.75em;
            }
            
            .info-box h3 {
                font-size: 1em;
            }
            
            .info-item {
                font-size: 0.85em;
                padding: 8px;
            }
            
            button {
                padding: 8px 15px;
                font-size: 12px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .stat-card h3 {
                font-size: 0.8em;
            }
            
            .stat-card .value {
                font-size: 1.3em;
            }
            
            .atm-machine {
                width: 150px;
                height: 220px;
            }
            
            .atm-screen {
                height: 70px;
                font-size: 11px;
            }
            
            .customer {
                width: 45px;
                height: 45px;
                font-size: 12px;
            }
            
            .queue-line {
                padding: 10px;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèß Discrete Event Simulation - Sistem Antrian ATM</h1>
        <p class="subtitle">Mode: PELANGGAN | Single Server | Jam 08:00 - 16:00 (480 menit)</p>
        
        <div class="info-box">
            <h3>üìã Parameter & Kriteria Simulasi</h3>
            <div class="info-grid">
                <div class="info-item">
                    <strong>Mode Simulasi:</strong> PELANGGAN
                </div>
                <div class="info-item">
                    <strong>Target Pelanggan:</strong> 25 orang
                </div>
                <div class="info-item">
                    <strong>Waktu Antar Kedatangan:</strong> 3.0 menit (Eksponensial)
                </div>
                <div class="info-item">
                    <strong>Waktu Pelayanan:</strong> 2.4 menit (Eksponensial)
                </div>
                <div class="info-item">
                    <strong>Jam Operasional:</strong> 08:00 - 16:00 (480 menit)
                </div>
                <div class="info-item">
                    <strong>Kapasitas ATM:</strong> 1 (Single Server)
                </div>
                <div class="info-item">
                    <strong>Disiplin Antrian:</strong> FIFO (First In First Out)
                </div>
                <div class="info-item">
                    <strong>Expected Waiting Time:</strong> 3.029 menit
                </div>
                <div class="info-item">
                    <strong>Avg Queue Length:</strong> 1.195 pelanggan
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn-start" onclick="startSimulation()">‚ñ∂Ô∏è Mulai Simulasi</button>
            <button class="btn-pause" onclick="pauseSimulation()">‚è∏Ô∏è Pause</button>
            <button class="btn-reset" onclick="resetSimulation()">üîÑ Reset</button>
            <div class="speed-control">
                <label>‚ö° Kecepatan:</label>
                <select id="speed" onchange="updateSpeed()">
                    <option value="2000">üêå Lambat</option>
                    <option value="1000" selected>üö∂ Normal</option>
                    <option value="500">üèÉ Cepat</option>
                    <option value="200">üöÄ Sangat Cepat</option>
                    <option value="50">‚ö° Kilat</option>
                </select>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h3>‚è∞ Waktu Simulasi</h3>
                <div class="value" id="currentTime">0.00</div>
                <small>menit</small>
            </div>
            <div class="stat-card">
                <h3>üë• Total Kedatangan</h3>
                <div class="value" id="totalArrivals">0</div>
                <small>pelanggan</small>
            </div>
            <div class="stat-card">
                <h3>‚úÖ Pelanggan Dilayani</h3>
                <div class="value" id="servedCount">0</div>
                <small id="servedLabel">dari 25</small>
            </div>
            <div class="stat-card">
                <h3>üìä Panjang Antrian</h3>
                <div class="value" id="queueLength">0</div>
                <small>pelanggan</small>
            </div>
            <div class="stat-card">
                <h3>‚è±Ô∏è Avg Wait Time</h3>
                <div class="value" id="avgWait">0.000</div>
                <small>menit</small>
            </div>
            <div class="stat-card">
                <h3>üìà Avg Queue Length</h3>
                <div class="value" id="avgQueueLen">0.000</div>
                <small>pelanggan</small>
            </div>
        </div>
        
        <div class="simulation-area">
            <div class="atm-section">
                <div class="atm-container">
                    <div class="atm-machine">
                        <div class="atm-screen" id="atmScreen">ATM READY</div>
                        <div class="atm-status idle" id="atmStatus">IDLE</div>
                        <div class="atm-keypad">
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                            <div class="key"></div>
                        </div>
                    </div>
                    <div class="atm-label">ATM Machine</div>
                </div>
                
                <div class="queue-area">
                    <div class="queue-label">
                        <span>üìã</span>
                        <span>Antrian Pelanggan (FIFO)</span>
                    </div>
                    <div class="queue-line" id="queueLine">
                        <div style="color: #999; font-style: italic; padding: 20px;">Antrian kosong - Tekan "Mulai Simulasi"</div>
                    </div>
                </div>
            </div>
            
            <div class="timeline">
                <div class="timeline-label">‚è±Ô∏è Progress Simulasi (0 - 480 menit):</div>
                <div class="timeline-bar">
                    <div class="timeline-progress" id="timelineProgress" style="width: 0%">0.0%</div>
                </div>
            </div>
        </div>
        
        <div class="event-log">
            <div class="event-log-title">üìú Event Log - Discrete Event Simulation</div>
            <div id="eventLog"></div>
        </div>
    </div>
    
    <script>
        // Data simulasi dari Python
        const simulationSteps = [{"Step": 1, "Event Type": "ARRIVAL", "Time (ti)": 1.408, "Customer ID": 0, "Queue Length (NQi)": 0, "ATM Status": "IDLE", "Customer at ATM": "-", "Time Delta (ti - ti-1)": 1.408, "Time-Weighted Queue": 0.0}, {"Step": 2, "Event Type": "ARRIVAL", "Time (ti)": 5.358, "Customer ID": 1, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 0, "Time Delta (ti - ti-1)": 3.95, "Time-Weighted Queue": 0.0}, {"Step": 3, "Event Type": "ARRIVAL", "Time (ti)": 8.097, "Customer ID": 2, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 0, "Time Delta (ti - ti-1)": 2.739, "Time-Weighted Queue": 2.739}, {"Step": 4, "Event Type": "ARRIVAL", "Time (ti)": 8.606, "Customer ID": 3, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 0, "Time Delta (ti - ti-1)": 0.509, "Time-Weighted Queue": 1.018}, {"Step": 5, "Event Type": "DEPARTURE", "Time (ti)": 8.632, "Customer ID": 0, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 0, "Time Delta (ti - ti-1)": 0.026, "Time-Weighted Queue": 0.079}, {"Step": 6, "Event Type": "DEPARTURE", "Time (ti)": 8.776, "Customer ID": 1, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 1, "Time Delta (ti - ti-1)": 0.144, "Time-Weighted Queue": 0.287}, {"Step": 7, "Event Type": "ARRIVAL", "Time (ti)": 9.115, "Customer ID": 4, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 2, "Time Delta (ti - ti-1)": 0.339, "Time-Weighted Queue": 0.339}, {"Step": 8, "Event Type": "ARRIVAL", "Time (ti)": 11.872, "Customer ID": 5, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 2, "Time Delta (ti - ti-1)": 2.757, "Time-Weighted Queue": 5.514}, {"Step": 9, "Event Type": "DEPARTURE", "Time (ti)": 13.603, "Customer ID": 2, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 2, "Time Delta (ti - ti-1)": 1.731, "Time-Weighted Queue": 5.193}, {"Step": 10, "Event Type": "DEPARTURE", "Time (ti)": 13.653, "Customer ID": 3, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 3, "Time Delta (ti - ti-1)": 0.05, "Time-Weighted Queue": 0.1}, {"Step": 11, "Event Type": "ARRIVAL", "Time (ti)": 15.566, "Customer ID": 6, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 4, "Time Delta (ti - ti-1)": 1.913, "Time-Weighted Queue": 1.913}, {"Step": 12, "Event Type": "ARRIVAL", "Time (ti)": 20.925, "Customer ID": 7, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 4, "Time Delta (ti - ti-1)": 5.359, "Time-Weighted Queue": 10.719}, {"Step": 13, "Event Type": "ARRIVAL", "Time (ti)": 21.641, "Customer ID": 8, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 4, "Time Delta (ti - ti-1)": 0.716, "Time-Weighted Queue": 2.148}, {"Step": 14, "Event Type": "DEPARTURE", "Time (ti)": 22.061, "Customer ID": 4, "Queue Length (NQi)": 4, "ATM Status": "BUSY", "Customer at ATM": 4, "Time Delta (ti - ti-1)": 0.42, "Time-Weighted Queue": 1.681}, {"Step": 15, "Event Type": "ARRIVAL", "Time (ti)": 22.243, "Customer ID": 9, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 5, "Time Delta (ti - ti-1)": 0.182, "Time-Weighted Queue": 0.545}, {"Step": 16, "Event Type": "DEPARTURE", "Time (ti)": 22.547, "Customer ID": 5, "Queue Length (NQi)": 4, "ATM Status": "BUSY", "Customer at ATM": 5, "Time Delta (ti - ti-1)": 0.304, "Time-Weighted Queue": 1.218}, {"Step": 17, "Event Type": "ARRIVAL", "Time (ti)": 23.331, "Customer ID": 10, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 6, "Time Delta (ti - ti-1)": 0.784, "Time-Weighted Queue": 2.351}, {"Step": 18, "Event Type": "DEPARTURE", "Time (ti)": 24.333, "Customer ID": 6, "Queue Length (NQi)": 4, "ATM Status": "BUSY", "Customer at ATM": 6, "Time Delta (ti - ti-1)": 1.002, "Time-Weighted Queue": 4.007}, {"Step": 19, "Event Type": "ARRIVAL", "Time (ti)": 25.028, "Customer ID": 11, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 7, "Time Delta (ti - ti-1)": 0.695, "Time-Weighted Queue": 2.085}, {"Step": 20, "Event Type": "DEPARTURE", "Time (ti)": 25.159, "Customer ID": 7, "Queue Length (NQi)": 4, "ATM Status": "BUSY", "Customer at ATM": 7, "Time Delta (ti - ti-1)": 0.131, "Time-Weighted Queue": 0.525}, {"Step": 21, "Event Type": "DEPARTURE", "Time (ti)": 25.52, "Customer ID": 8, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 8, "Time Delta (ti - ti-1)": 0.361, "Time-Weighted Queue": 1.082}, {"Step": 22, "Event Type": "DEPARTURE", "Time (ti)": 26.349, "Customer ID": 9, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 9, "Time Delta (ti - ti-1)": 0.829, "Time-Weighted Queue": 1.658}, {"Step": 23, "Event Type": "DEPARTURE", "Time (ti)": 27.444, "Customer ID": 10, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 10, "Time Delta (ti - ti-1)": 1.095, "Time-Weighted Queue": 1.095}, {"Step": 24, "Event Type": "ARRIVAL", "Time (ti)": 27.867, "Customer ID": 12, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 11, "Time Delta (ti - ti-1)": 0.423, "Time-Weighted Queue": 0.0}, {"Step": 25, "Event Type": "DEPARTURE", "Time (ti)": 28.905, "Customer ID": 11, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 11, "Time Delta (ti - ti-1)": 1.038, "Time-Weighted Queue": 1.038}, {"Step": 26, "Event Type": "DEPARTURE", "Time (ti)": 29.44, "Customer ID": 12, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 12, "Time Delta (ti - ti-1)": 0.535, "Time-Weighted Queue": 0.0}, {"Step": 27, "Event Type": "ARRIVAL", "Time (ti)": 32.481, "Customer ID": 13, "Queue Length (NQi)": 0, "ATM Status": "IDLE", "Customer at ATM": "-", "Time Delta (ti - ti-1)": 3.041, "Time-Weighted Queue": 0.0}, {"Step": 28, "Event Type": "DEPARTURE", "Time (ti)": 34.214, "Customer ID": 13, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 13, "Time Delta (ti - ti-1)": 1.733, "Time-Weighted Queue": 0.0}, {"Step": 29, "Event Type": "ARRIVAL", "Time (ti)": 35.173, "Customer ID": 14, "Queue Length (NQi)": 0, "ATM Status": "IDLE", "Customer at ATM": "-", "Time Delta (ti - ti-1)": 0.96, "Time-Weighted Queue": 0.0}, {"Step": 30, "Event Type": "DEPARTURE", "Time (ti)": 35.287, "Customer ID": 14, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 14, "Time Delta (ti - ti-1)": 0.114, "Time-Weighted Queue": 0.0}, {"Step": 31, "Event Type": "ARRIVAL", "Time (ti)": 37.979, "Customer ID": 15, "Queue Length (NQi)": 0, "ATM Status": "IDLE", "Customer at ATM": "-", "Time Delta (ti - ti-1)": 2.692, "Time-Weighted Queue": 0.0}, {"Step": 32, "Event Type": "ARRIVAL", "Time (ti)": 38.181, "Customer ID": 16, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 15, "Time Delta (ti - ti-1)": 0.202, "Time-Weighted Queue": 0.0}, {"Step": 33, "Event Type": "DEPARTURE", "Time (ti)": 38.428, "Customer ID": 15, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 15, "Time Delta (ti - ti-1)": 0.247, "Time-Weighted Queue": 0.247}, {"Step": 34, "Event Type": "DEPARTURE", "Time (ti)": 46.517, "Customer ID": 16, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 16, "Time Delta (ti - ti-1)": 8.09, "Time-Weighted Queue": 0.0}, {"Step": 35, "Event Type": "ARRIVAL", "Time (ti)": 47.102, "Customer ID": 17, "Queue Length (NQi)": 0, "ATM Status": "IDLE", "Customer at ATM": "-", "Time Delta (ti - ti-1)": 0.585, "Time-Weighted Queue": 0.0}, {"Step": 36, "Event Type": "ARRIVAL", "Time (ti)": 48.192, "Customer ID": 18, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 17, "Time Delta (ti - ti-1)": 1.09, "Time-Weighted Queue": 0.0}, {"Step": 37, "Event Type": "ARRIVAL", "Time (ti)": 48.5, "Customer ID": 19, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 17, "Time Delta (ti - ti-1)": 0.308, "Time-Weighted Queue": 0.308}, {"Step": 38, "Event Type": "DEPARTURE", "Time (ti)": 51.068, "Customer ID": 17, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 17, "Time Delta (ti - ti-1)": 2.567, "Time-Weighted Queue": 5.135}, {"Step": 39, "Event Type": "ARRIVAL", "Time (ti)": 51.959, "Customer ID": 20, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 18, "Time Delta (ti - ti-1)": 0.891, "Time-Weighted Queue": 0.891}, {"Step": 40, "Event Type": "ARRIVAL", "Time (ti)": 52.349, "Customer ID": 21, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 18, "Time Delta (ti - ti-1)": 0.39, "Time-Weighted Queue": 0.781}, {"Step": 41, "Event Type": "DEPARTURE", "Time (ti)": 52.46, "Customer ID": 18, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 18, "Time Delta (ti - ti-1)": 0.111, "Time-Weighted Queue": 0.333}, {"Step": 42, "Event Type": "DEPARTURE", "Time (ti)": 52.544, "Customer ID": 19, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 19, "Time Delta (ti - ti-1)": 0.084, "Time-Weighted Queue": 0.168}, {"Step": 43, "Event Type": "ARRIVAL", "Time (ti)": 54.4, "Customer ID": 22, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 20, "Time Delta (ti - ti-1)": 1.856, "Time-Weighted Queue": 1.856}, {"Step": 44, "Event Type": "ARRIVAL", "Time (ti)": 55.298, "Customer ID": 23, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 20, "Time Delta (ti - ti-1)": 0.898, "Time-Weighted Queue": 1.797}, {"Step": 45, "Event Type": "DEPARTURE", "Time (ti)": 58.305, "Customer ID": 20, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 20, "Time Delta (ti - ti-1)": 3.007, "Time-Weighted Queue": 9.021}, {"Step": 46, "Event Type": "ARRIVAL", "Time (ti)": 58.557, "Customer ID": 24, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 21, "Time Delta (ti - ti-1)": 0.252, "Time-Weighted Queue": 0.504}, {"Step": 47, "Event Type": "DEPARTURE", "Time (ti)": 59.201, "Customer ID": 21, "Queue Length (NQi)": 3, "ATM Status": "BUSY", "Customer at ATM": 21, "Time Delta (ti - ti-1)": 0.645, "Time-Weighted Queue": 1.934}, {"Step": 48, "Event Type": "DEPARTURE", "Time (ti)": 60.963, "Customer ID": 22, "Queue Length (NQi)": 2, "ATM Status": "BUSY", "Customer at ATM": 22, "Time Delta (ti - ti-1)": 1.762, "Time-Weighted Queue": 3.524}, {"Step": 49, "Event Type": "DEPARTURE", "Time (ti)": 62.862, "Customer ID": 23, "Queue Length (NQi)": 1, "ATM Status": "BUSY", "Customer at ATM": 23, "Time Delta (ti - ti-1)": 1.899, "Time-Weighted Queue": 1.899}, {"Step": 50, "Event Type": "DEPARTURE", "Time (ti)": 63.353, "Customer ID": 24, "Queue Length (NQi)": 0, "ATM Status": "BUSY", "Customer at ATM": 24, "Time Delta (ti - ti-1)": 0.491, "Time-Weighted Queue": 0.0}];
        const customerData = [{"Customer ID": 0, "Arrival Time": 1.408, "Service Start": 1.408, "Service End": 8.632, "Wait Time": 0.0, "Service Time": 7.224, "Time in System": 7.224}, {"Customer ID": 1, "Arrival Time": 5.358, "Service Start": 8.632, "Service End": 8.776, "Wait Time": 3.274, "Service Time": 0.144, "Time in System": 3.418}, {"Customer ID": 2, "Arrival Time": 8.097, "Service Start": 8.776, "Service End": 13.603, "Wait Time": 0.679, "Service Time": 4.827, "Time in System": 5.506}, {"Customer ID": 3, "Arrival Time": 8.606, "Service Start": 13.603, "Service End": 13.653, "Wait Time": 4.997, "Service Time": 0.05, "Time in System": 5.047}, {"Customer ID": 4, "Arrival Time": 9.115, "Service Start": 13.653, "Service End": 22.061, "Wait Time": 4.538, "Service Time": 8.409, "Time in System": 12.947}, {"Customer ID": 5, "Arrival Time": 11.872, "Service Start": 22.061, "Service End": 22.547, "Wait Time": 10.189, "Service Time": 0.486, "Time in System": 10.676}, {"Customer ID": 6, "Arrival Time": 15.566, "Service Start": 22.547, "Service End": 24.333, "Wait Time": 6.982, "Service Time": 1.785, "Time in System": 8.767}, {"Customer ID": 7, "Arrival Time": 20.925, "Service Start": 24.333, "Service End": 25.159, "Wait Time": 3.408, "Service Time": 0.826, "Time in System": 4.234}, {"Customer ID": 8, "Arrival Time": 21.641, "Service Start": 25.159, "Service End": 25.52, "Wait Time": 3.518, "Service Time": 0.361, "Time in System": 3.879}, {"Customer ID": 9, "Arrival Time": 22.243, "Service Start": 25.52, "Service End": 26.349, "Wait Time": 3.277, "Service Time": 0.829, "Time in System": 4.106}, {"Customer ID": 10, "Arrival Time": 23.331, "Service Start": 26.349, "Service End": 27.444, "Wait Time": 3.018, "Service Time": 1.095, "Time in System": 4.113}, {"Customer ID": 11, "Arrival Time": 25.028, "Service Start": 27.444, "Service End": 28.905, "Wait Time": 2.416, "Service Time": 1.461, "Time in System": 3.877}, {"Customer ID": 12, "Arrival Time": 27.867, "Service Start": 28.905, "Service End": 29.44, "Wait Time": 1.038, "Service Time": 0.535, "Time in System": 1.573}, {"Customer ID": 13, "Arrival Time": 32.481, "Service Start": 32.481, "Service End": 34.214, "Wait Time": 0.0, "Service Time": 1.733, "Time in System": 1.733}, {"Customer ID": 14, "Arrival Time": 35.173, "Service Start": 35.173, "Service End": 35.287, "Wait Time": 0.0, "Service Time": 0.114, "Time in System": 0.114}, {"Customer ID": 15, "Arrival Time": 37.979, "Service Start": 37.979, "Service End": 38.428, "Wait Time": 0.0, "Service Time": 0.449, "Time in System": 0.449}, {"Customer ID": 16, "Arrival Time": 38.181, "Service Start": 38.428, "Service End": 46.517, "Wait Time": 0.247, "Service Time": 8.09, "Time in System": 8.336}, {"Customer ID": 17, "Arrival Time": 47.102, "Service Start": 47.102, "Service End": 51.068, "Wait Time": 0.0, "Service Time": 3.966, "Time in System": 3.966}, {"Customer ID": 18, "Arrival Time": 48.192, "Service Start": 51.068, "Service End": 52.46, "Wait Time": 2.876, "Service Time": 1.392, "Time in System": 4.268}, {"Customer ID": 19, "Arrival Time": 48.5, "Service Start": 52.46, "Service End": 52.544, "Wait Time": 3.96, "Service Time": 0.084, "Time in System": 4.044}, {"Customer ID": 20, "Arrival Time": 51.959, "Service Start": 52.544, "Service End": 58.305, "Wait Time": 0.585, "Service Time": 5.761, "Time in System": 6.346}, {"Customer ID": 21, "Arrival Time": 52.349, "Service Start": 58.305, "Service End": 59.201, "Wait Time": 5.956, "Service Time": 0.897, "Time in System": 6.852}, {"Customer ID": 22, "Arrival Time": 54.4, "Service Start": 59.201, "Service End": 60.963, "Wait Time": 4.802, "Service Time": 1.762, "Time in System": 6.564}, {"Customer ID": 23, "Arrival Time": 55.298, "Service Start": 60.963, "Service End": 62.862, "Wait Time": 5.665, "Service Time": 1.899, "Time in System": 7.564}, {"Customer ID": 24, "Arrival Time": 58.557, "Service Start": 62.862, "Service End": 63.353, "Wait Time": 4.305, "Service Time": 0.491, "Time in System": 4.796}];
        const SIMULATION_TIME = 480;
        const TOTAL_CUSTOMERS = 25;
        const SIMULATION_MODE = 'PELANGGAN';
        
        let currentStep = 0;
        let isRunning = false;
        let isPaused = false;
        let speed = 1000;
        let intervalId = null;
        let totalArrivals = 0;
        let servedCount = 0;
        
        function addEvent(message, isCurrent = false) {
            const eventLog = document.getElementById('eventLog');
            const event = document.createElement('div');
            event.className = isCurrent ? 'event current-event' : 'event';
            event.innerHTML = message;
            eventLog.insertBefore(event, eventLog.firstChild);
            
            // Limit log to 100 entries
            if (eventLog.children.length > 100) {
                eventLog.removeChild(eventLog.lastChild);
            }
        }
        
        function updateVisualization(step) {
            const currentTime = step['Time (ti)'];
            const eventType = step['Event Type'];
            const customerId = step['Customer ID'];
            const queueLength = step['Queue Length (NQi)'];
            const atmStatus = step['ATM Status'];
            const customerAtATM = step['Customer at ATM'];
            
            // Update stats
            document.getElementById('currentTime').textContent = currentTime.toFixed(2);
            document.getElementById('queueLength').textContent = queueLength;
            
            // Update timeline
            const progress = (currentTime / SIMULATION_TIME) * 100;
            document.getElementById('timelineProgress').style.width = Math.min(progress, 100) + '%';
            document.getElementById('timelineProgress').textContent = Math.min(progress, 100).toFixed(1) + '%';
            
            // Update ATM status
            const atmStatusElement = document.getElementById('atmStatus');
            if (atmStatus === 'BUSY') {
                atmStatusElement.textContent = 'BUSY';
                atmStatusElement.className = 'atm-status busy';
                document.getElementById('atmScreen').textContent = `Customer #${customerAtATM}`;
            } else {
                atmStatusElement.textContent = 'IDLE';
                atmStatusElement.className = 'atm-status idle';
                document.getElementById('atmScreen').textContent = 'ATM READY';
            }
            
            // Update queue visualization
            updateQueueVisualization(queueLength, customerAtATM, atmStatus, currentTime);
            
            // Add event to log
            let eventMessage = `<span class="event-time">[t=${currentTime.toFixed(2)} min]</span> `;
            
            if (eventType === 'ARRIVAL') {
                totalArrivals++;
                document.getElementById('totalArrivals').textContent = totalArrivals;
                eventMessage += `<span class="event-arrival">üîµ ARRIVAL</span> - <span class="event-customer">Customer #${customerId}</span> tiba di ATM`;
                eventMessage += ` | Antrian: ${queueLength} | ATM: ${atmStatus}`;
                addEvent(eventMessage, true);
            } else if (eventType === 'DEPARTURE') {
                servedCount++;
                document.getElementById('servedCount').textContent = servedCount;
                eventMessage += `<span class="event-departure">üî¥ DEPARTURE</span> - <span class="event-customer">Customer #${customerId}</span> selesai dilayani`;
                eventMessage += ` | Antrian: ${queueLength} | ATM: ${atmStatus}`;
                addEvent(eventMessage, true);
            }
        }
        
        function updateQueueVisualization(queueLength, customerAtATM, atmStatus, currentTime) {
            const queueLine = document.getElementById('queueLine');
            queueLine.innerHTML = '';
            
            // Show customer being served
            if (atmStatus === 'BUSY' && customerAtATM !== '-') {
                const servingCustomer = document.createElement('div');
                servingCustomer.className = 'customer serving';
                servingCustomer.textContent = customerAtATM;
                servingCustomer.setAttribute('data-info', `Being Served`);
                servingCustomer.title = `Customer #${customerAtATM} - Being Served`;
                queueLine.appendChild(servingCustomer);
            }
            
            // Show customers waiting in queue
            if (queueLength > 0) {
                for (let i = 0; i < queueLength; i++) {
                    const customer = document.createElement('div');
                    customer.className = 'customer waiting';
                    customer.textContent = '?';
                    customer.setAttribute('data-info', `Position ${i + 1}`);
                    customer.title = `Waiting - Position ${i + 1}`;
                    queueLine.appendChild(customer);
                }
            } else if (atmStatus === 'IDLE') {
                const emptyMsg = document.createElement('div');
                emptyMsg.style.color = '#999';
                emptyMsg.style.fontStyle = 'italic';
                emptyMsg.style.padding = '20px';
                emptyMsg.textContent = 'Antrian kosong';
                queueLine.appendChild(emptyMsg);
            }
        }
        
        function processNextStep() {
            if (currentStep >= simulationSteps.length) {
                stopSimulation();
                addEvent('<span class="event-action">‚úÖ SIMULASI SELESAI! Semua ${TOTAL_CUSTOMERS} pelanggan telah diproses.</span>', true);
                
                // Calculate and display final statistics
                calculateFinalStatistics();
                
                return;
            }
            
            const step = simulationSteps[currentStep];
            updateVisualization(step);
            currentStep++;
        }
        
        function calculateFinalStatistics() {
            let totalWait = 0;
            let count = 0;
            
            customerData.forEach(cust => {
                totalWait += cust['Wait Time'];
                count++;
            });
            
            const avgWait = count > 0 ? totalWait / count : 0;
            
            // Calculate time-weighted average queue length
            let totalTimeWeighted = 0;
            simulationSteps.forEach(step => {
                totalTimeWeighted += step['Time-Weighted Queue'];
            });
            
            const lastTime = simulationSteps[simulationSteps.length - 1]['Time (ti)'];
            const avgQueueLen = lastTime > 0 ? totalTimeWeighted / lastTime : 0;
            
            document.getElementById('avgWait').textContent = avgWait.toFixed(3);
            document.getElementById('avgQueueLen').textContent = avgQueueLen.toFixed(3);
            
            addEvent(`<span class="event-action">üìä Expected Waiting Time: ${avgWait.toFixed(3)} menit</span>`);
            addEvent(`<span class="event-action">üìä Time-Average Queue Length: ${avgQueueLen.toFixed(3)} pelanggan</span>`);
        }
        
        function startSimulation() {
            if (isRunning && !isPaused) return;
            
            isRunning = true;
            isPaused = false;
            
            if (currentStep === 0) {
                addEvent('<span class="event-action">üöÄ SIMULASI DIMULAI</span>', true);
                addEvent('<span class="event-action">‚öôÔ∏è Discrete Event Simulation - Single Server Queue System</span>');
                addEvent('<span class="event-action">üìò Distribusi: Eksponensial | Disiplin: FIFO</span>');
            } else {
                addEvent('<span class="event-action">‚ñ∂Ô∏è Simulasi dilanjutkan...</span>', true);
            }
            
            intervalId = setInterval(processNextStep, speed);
        }
        
        function pauseSimulation() {
            if (!isRunning || isPaused) return;
            
            isPaused = true;
            clearInterval(intervalId);
            addEvent('<span class="event-action">‚è∏Ô∏è Simulasi dijeda</span>', true);
        }
        
        function stopSimulation() {
            isRunning = false;
            isPaused = false;
            clearInterval(intervalId);
        }
        
        function resetSimulation() {
            stopSimulation();
            currentStep = 0;
            totalArrivals = 0;
            servedCount = 0;
            
            document.getElementById('currentTime').textContent = '0.00';
            document.getElementById('totalArrivals').textContent = '0';
            document.getElementById('servedCount').textContent = '0';
            document.getElementById('queueLength').textContent = '0';
            document.getElementById('avgWait').textContent = '0.000';
            document.getElementById('avgQueueLen').textContent = '0.000';
            document.getElementById('atmScreen').textContent = 'ATM READY';
            document.getElementById('atmStatus').textContent = 'IDLE';
            document.getElementById('atmStatus').className = 'atm-status idle';
            document.getElementById('queueLine').innerHTML = '<div style="color: #999; font-style: italic; padding: 20px;">Antrian kosong - Tekan "Mulai Simulasi"</div>';
            document.getElementById('eventLog').innerHTML = '';
            document.getElementById('timelineProgress').style.width = '0%';
            document.getElementById('timelineProgress').textContent = '0.0%';
            
            addEvent('<span class="event-action">üîÑ Simulasi direset - Siap untuk dijalankan kembali</span>', true);
        }
        
        function updateSpeed() {
            speed = parseInt(document.getElementById('speed').value);
            if (isRunning && !isPaused) {
                clearInterval(intervalId);
                intervalId = setInterval(processNextStep, speed);
            }
        }
        
        // Initialize
        addEvent('<span class="event-action">‚ú® Discrete Event Simulation siap untuk dijalankan</span>');
        addEvent('<span class="event-action">üìò Tekan tombol "Mulai Simulasi" untuk memulai</span>');
        addEvent(`<span class="event-action">üë• Total: ${TOTAL_CUSTOMERS} pelanggan | ‚è±Ô∏è Durasi: ${SIMULATION_TIME} menit</span>`);
    </script>
</body>
</html>